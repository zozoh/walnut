命令简介
======= 

`www price` 预先计算订单价格，包括运费和优惠

本命令接受输入 JSON:

```js
{
  // 商品列表
  "products": [{
    "id": "78u..sg9",      // 商品 ID
    "amount": 3            // 购买数量，默认为 1
  }],

  //【选】需要物流信息的订单需要填写
  "addr_ship_country" : "CN",         // 国家编码，默认 CN
  "addr_user_code" : "110108017000",  // 收货地址（12位地址编码）

  //【选】优惠券ID
  "coupons": [{"id":ID}]
}
```

用法
=======

```bash
www price
    [id:xxx]        # 【必】站点主目录路径，
                    # 主目录必须设置了orders(订单库)/products(商品库)
                    # 以便进行服务器校验。数据集均为 Thing
    #-----------------------------------------------
    # 【选】商品价格为动态规则
    # 这个要求商品对象指定两个选项
    #  - pro_id   : 应用哪个规则(值为规则 ID)
    #  - price_by : 采用规则列表里的哪个规则
    # 本选项的值表示，规则对象的哪个键存放了规则列表，默认为 prices
    # 支持 "@content" 这样的特殊键，表示对象的内容为规则列表
    [-prices prices],
    #-----------------------------------------------
    # 创建支付单时，从用户元数据挑选选数据
    # 这个是一个映射表 {"用户元数据键" : "支付单键"}
    [-upick {wx_mp_xxx:"wx_openid"]
    #-----------------------------------------------
    # 输出的JSON数据的配置信息
    [-cqn]    # JSON 输出的格式化方式
    [-ajax]   # 开启这个选项，则输出为 ajaxReturn 的包裹
```

示例
=======

```bash
# >>>>>>>>>>>>>>>>>>>>>
# 如果我们有一个  order.json ，内容类似：
demo:> cat order.json
{
  "products": [{
    "id": "7o7j07o08ujtfqq04kaaaagsg9", 
    "amount": 3
  }],
  "pay_tp" : "wx.qrcode"
}
# >>>>>>>>>>>>>>>>>>>>>
# 预先计算订单商品价格
demo:> cat order.json | www price ~/www
{
  #------------------------------------
  # 运费部分详情
  "freightDetail" : {
    # 根据输入分析的重量
    "weight" : {
      "first"      : 1,       # 首重（公斤）
      "additional" : 21.5,    # 续重（公斤）
    },
    # 找到的匹配规则
    "rule" : {
      "title"        : "北京至全国",  # 标题（助记）
      "ship_code"    : "110000",     # 发货地（六位地址编码）
      "target_code"  : "000000",     # 目的地址（六位地址编码）
      "first"        : 10.5,         # 首重价格（元）
      "additional"   : 0.8           # 续重价格（元）
    },
    "first"      : 10.5,       # 首重价格（元）
    "additional" : 32,         # 续重总价格（元）
    "total"      : 42.5        # 总运费
  },
  #------------------------------------
  # 价格详情
  #------------------------------------------
  # 订单总金额 = total + freight
  # 支付总金额 = total + freight - discount
  #------------------------------------------
  "total"    : 245.12,    # 商品总金额
  "freight"  : 23.5,      # 运费
  "discount" : 16.8,      # 优惠金额
  "price"    : 321.56,    # 订单总金额（包括运费）
  "fee"      : 319.12     # 优惠后金额，用来实际支付
}
```