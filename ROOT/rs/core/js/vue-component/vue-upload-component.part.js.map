{"version":3,"file":"vue-upload-component.part.js","sources":["../src/InputFile.vue","../src/FileUpload.vue","../src/index.js"],"sourcesContent":["<template>\n  <input\n    type=\"file\"\n    :name=\"$parent.name\"\n    :id=\"$parent.inputId || $parent.name\"\n    :accept=\"$parent.accept\"\n    @change=\"change\"\n    :webkitdirectory=\"$parent.directory && $parent.features.directory\"\n    :directory=\"$parent.directory && $parent.features.directory\"\n    :multiple=\"$parent.multiple && $parent.features.html5\"\n  />\n</template>\n<script>\nexport default {\n  methods: {\n    change(e) {\n      this.$destroy()\n      this.$parent.addInputFile(e.target)\n      // eslint-disable-next-line\n      new this.constructor({\n        parent: this.$parent,\n        el: this.$el,\n      })\n    }\n  }\n}\n</script>\n","<template>\n  <label :class=\"className\">\n    <slot></slot>\n    <input-file></input-file>\n  </label>\n</template>\n<style>\n.file-uploads {\n  overflow: hidden;\n  position: relative;\n  text-align: center;\n  display: inline-block;\n}\n.file-uploads.file-uploads-html4 input[type=\"file\"] {\n  opacity: 0;\n  font-size: 20em;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n.file-uploads.file-uploads-html5 input[type=\"file\"] {\n  overflow: hidden;\n  position: fixed;\n  width: 1px;\n  height: 1px;\n  z-index: -1;\n  opacity: 0;\n}\n</style>\n<script>\nimport InputFile from './InputFile.vue'\nexport default {\n  components: {\n    InputFile,\n  },\n  props: {\n    inputId: {\n      type: String,\n    },\n\n    name: {\n      type: String,\n      default: 'file',\n    },\n\n    accept: {\n      type: String,\n    },\n\n    multiple: {\n      type: Boolean,\n    },\n\n    addIndex: {\n      type: [Boolean, Number],\n    },\n\n    directory: {\n      type: Boolean,\n    },\n\n    postAction: {\n      type: String,\n    },\n\n    putAction: {\n      type: String,\n    },\n\n    headers: {\n      type: Object,\n      default: Object,\n    },\n\n    data: {\n      type: Object,\n      default: Object,\n    },\n\n    timeout: {\n      type: Number,\n      default: 0,\n    },\n\n\n    drop: {\n      default: false,\n    },\n\n    dropDirectory: {\n      type: Boolean,\n      default: true,\n    },\n\n    size: {\n      type: Number,\n      default: 0,\n    },\n\n    extensions: {\n      default: Array,\n    },\n\n\n    value: {\n      type: Array,\n      default: Array,\n    },\n\n    thread: {\n      type: Number,\n      default: 1,\n    },\n  },\n\n  data() {\n    return {\n      files: this.value,\n      features: {\n        html5: true,\n        directory: false,\n        drag: false,\n      },\n\n      active: false,\n      dropActive: false,\n\n      uploading: 0,\n\n      destroy: false,\n    }\n  },\n\n\n  /**\n   * mounted\n   * @return {[type]} [description]\n   */\n  mounted() {\n    let input = document.createElement('input')\n    input.type = 'file'\n    input.multiple = true\n\n    // html5 特征\n    if (window.FormData && input.files) {\n      // 上传目录特征\n      if (typeof input.webkitdirectory === 'boolean' || typeof input.directory === 'boolean') {\n        this.features.directory = true\n      }\n\n      // 拖拽特征\n      if (this.features.html5 && typeof input.ondrop !== 'undefined') {\n        this.features.drop = true\n      }\n    } else {\n      this.features.html5 = false\n    }\n\n    // files 定位缓存\n    this.maps = {}\n\n    this.$nextTick(function () {\n\n      // 更新下父级\n      if (this.$parent) {\n        this.$parent.$forceUpdate()\n      }\n\n      // 拖拽渲染\n      this.watchDrop(this.drop)\n    })\n  },\n\n  /**\n   * beforeDestroy\n   * @return {[type]} [description]\n   */\n  beforeDestroy() {\n    // 已销毁\n    this.destroy = true\n\n    // 设置成不激活\n    this.active = false\n  },\n\n  computed: {\n    /**\n     * uploading 正在上传的线程\n     * @return {[type]} [description]\n     */\n\n    /**\n     * uploaded 文件列表是否全部已上传\n     * @return {[type]} [description]\n     */\n    uploaded() {\n      let file\n      for (let i = 0; i < this.files.length; i++) {\n        file = this.files[i]\n        if (file.fileObject && !file.error && !file.success) {\n          return false\n        }\n      }\n      return true\n    },\n\n\n    className() {\n      return [\n        'file-uploads',\n        this.features.html5 ? 'file-uploads-html5' : 'file-uploads-html4',\n        this.features.directory && this.directory ? 'file-uploads-directory' : undefined,\n        this.features.drop && this.drop ? 'file-uploads-drop' : undefined,\n      ]\n    }\n  },\n\n\n  watch: {\n    active(active) {\n      this.watchActive(active)\n    },\n\n    dropActive() {\n      if (this.$parent) {\n        this.$parent.$forceUpdate()\n      }\n    },\n\n    drop(value) {\n      this.watchDrop(value)\n    },\n\n    value(files) {\n      if (this.files === files) {\n        return\n      }\n      this.files = files\n\n      let oldMaps = this.maps\n\n      // 重写 maps 缓存\n      this.maps = {}\n      for (let i = 0; i < this.files.length; i++) {\n        let file = this.files[i]\n        this.maps[file.id] = file\n      }\n\n      // add, update\n      for (let key in this.maps) {\n        let newFile = this.maps[key]\n        let oldFile = oldMaps[key]\n        if (newFile !== oldFile) {\n          this.emitFile(newFile, oldFile)\n        }\n      }\n\n      // delete\n      for (let key in oldMaps) {\n        if (!this.maps[key]) {\n          this.emitFile(undefined, oldMaps[key])\n        }\n      }\n    },\n  },\n\n  methods: {\n\n    // 清空\n    clear() {\n      if (this.files.length) {\n        let files = this.files\n        this.files = []\n\n        // 定位\n        this.maps = {}\n\n        // 事件\n        this.emitInput()\n        for (let i = 0; i < files.length; i++) {\n          this.emitFile(undefined, files[i])\n        }\n      }\n      return true\n    },\n\n    // 选择\n    get(id) {\n      if (!id) {\n        return false\n      }\n\n      if (typeof id === 'object') {\n        return this.maps[id.id] || false\n      }\n\n      return this.maps[id] || false\n    },\n\n    // 添加\n    add(_files, index = this.addIndex) {\n      let files = _files\n      let isArray = files instanceof Array\n\n      // 不是数组整理成数组\n      if (!isArray) {\n        files = [files]\n      }\n\n      // 遍历规范对象\n      let addFiles = []\n      for (let i = 0; i < files.length; i++) {\n        let file = files[i]\n        if (this.features.html5 && file instanceof Blob) {\n          file = {\n            file,\n            size: file.size,\n            name: file.webkitRelativePath || file.relativePath || file.name || 'unknown',\n            type: file.type,\n          }\n        }\n        let fileObject = false\n        if (file.fileObject === false) {\n          // false\n        } else if (file.fileObject) {\n          fileObject = true\n        } else if (typeof Element !== 'undefined' && file.el instanceof Element) {\n          fileObject = true\n        } else if (typeof Blob !== 'undefined' && file.file instanceof Blob) {\n          fileObject = true\n        }\n        if (fileObject) {\n          file = {\n            fileObject: true,\n            size: -1,\n            name: 'Filename',\n            type: '',\n            active: false,\n            error: '',\n            success: false,\n            putAction: this.putAction,\n            postAction: this.postAction,\n            timeout: this.timeout,\n            ...file,\n            response: {},\n\n            progress: '0.00',          // 只读\n            speed: 0,                  // 只读\n            // xhr: false,                // 只读\n            // iframe: false,             // 只读\n          }\n\n          file.data = {\n            ...this.data,\n            ...file.data ? file.data : {},\n          }\n\n          file.headers = {\n            ...this.headers,\n            ...file.headers ? file.headers : {},\n          }\n        }\n\n        // 必须包含 id\n        if (!file.id) {\n          file.id = Math.random().toString(36).substr(2)\n        }\n\n        if (this.emitFilter(file, undefined)) {\n          continue\n        }\n\n        addFiles.push(file)\n\n        // 只允许单个文件\n        if (!this.multiple) {\n          break\n        }\n      }\n\n      // 没有文件\n      if (!addFiles.length) {\n        return false\n      }\n\n\n      // 只允许单个文件 删除所有\n      if (!this.multiple) {\n        this.clear()\n      }\n\n\n      // 添加进去 files\n      let newFiles\n      if (index === true || index === 0) {\n        newFiles = addFiles.concat(this.files)\n      } else if (index) {\n        newFiles = addFiles.concat([])\n        newFiles.splice(index, 0, addFiles)\n      } else {\n        newFiles = this.files.concat(addFiles)\n      }\n\n      this.files = newFiles\n\n      // 定位\n      for (let i = 0; i < addFiles.length; i++) {\n        let file = addFiles[i]\n        this.maps[file.id] = file\n      }\n\n      // 事件\n      this.emitInput()\n      for (let i = 0; i < addFiles.length; i++) {\n        this.emitFile(addFiles[i], undefined)\n      }\n\n      return isArray ? addFiles : addFiles[0]\n    },\n\n\n\n    // 添加表单文件\n    addInputFile(el) {\n      let files = []\n      if (el.files) {\n        for (let i = 0; i < el.files.length; i++) {\n          let file = el.files[i]\n          files.push({\n            size: file.size,\n            name: file.webkitRelativePath || file.relativePath || file.name,\n            type: file.type,\n            file,\n            el\n          })\n        }\n      } else {\n        files.push({\n          name: el.value.replace(/^.*?([^\\/\\\\\\r\\n]+)$/, '$1'),\n          el,\n        })\n      }\n      return this.add(files)\n    },\n\n\n    // 添加 DataTransfer\n    addDataTransfer(dataTransfer) {\n      let files = []\n      if (dataTransfer.items && dataTransfer.items.length) {\n        let items = []\n        for (let i = 0; i < dataTransfer.items.length; i++) {\n          let item = dataTransfer.items[i]\n          if (item.getAsEntry) {\n            item = item.getAsEntry()\n          } else if (item.webkitGetAsEntry) {\n            item = item.webkitGetAsEntry()\n          } else {\n            item = item.getAsFile()\n          }\n          if (item) {\n            items.push(item)\n          }\n        }\n\n        return new Promise((resolve, reject) => {\n          let forEach = (i) => {\n            let item = items[i]\n            // 结束 或者已有文件了\n            if (!item || (!this.multiple && files.length)) {\n              return resolve(this.add(files))\n            }\n            this.getEntry(item).then(function (results) {\n              files.push(...results)\n              forEach(i + 1)\n            })\n          }\n          forEach(0)\n        })\n      }\n\n      if (dataTransfer.files.length) {\n        for (let i = 0; i < dataTransfer.files.length; i++) {\n          files.push(dataTransfer.files[i])\n          if (!this.multiple) {\n            break\n          }\n        }\n        return Promise.resolve(this.add(files))\n      }\n\n      return Promise.resolve([])\n    },\n\n\n    // 获得 entry\n    getEntry(entry, path = '') {\n      return new Promise((resolve, reject) => {\n        if (entry.isFile) {\n          entry.file(function (file) {\n            resolve([\n              {\n                size: file.size,\n                name: path + file.name,\n                type: file.type,\n                file,\n              }\n            ])\n          })\n        } else if (entry.isDirectory && this.dropDirectory) {\n          entry.createReader().readEntries((entries) => {\n            let files = []\n            let forEach = (i) => {\n              if (!entries[i] || (files.length && !this.multiple)) {\n                return resolve(files)\n              }\n              this.getEntry(entries[i], path + entry.name + '/').then((results) => {\n                files.push(...results)\n                forEach(i + 1)\n              })\n            }\n            forEach(0)\n          })\n        } else {\n          resolve([])\n        }\n      })\n    },\n\n\n    replace(id1, id2) {\n      let file1 = this.get(id1)\n      let file2 = this.get(id2)\n      if (!file1 || !file2 || file1 === file2) {\n        return false\n      }\n      let files = this.files.concat([])\n      let index1 = files.indexOf(file1)\n      let index2 = files.indexOf(file2)\n      if (index1 === -1 || index2 === -1) {\n        return false\n      }\n      files[index1] = file2\n      files[index2] = file1\n      this.files = files\n      this.emitInput()\n      return true\n    },\n\n    // 移除\n    remove(id) {\n      let file = this.get(id)\n      if (file) {\n        if (this.emitFilter(undefined, file)) {\n          return false\n        }\n        let files = this.files.concat([])\n        let index = files.indexOf(file)\n        if (index === -1) {\n          console.error('remove', file)\n          return false\n        }\n        files.splice(index, 1)\n        this.files = files\n\n        // 定位\n        delete this.maps[file.id]\n\n        // 事件\n        this.emitInput()\n        this.emitFile(undefined, file)\n      }\n      return file\n    },\n\n    // 更新\n    update(id, data) {\n      let file = this.get(id)\n      if (file) {\n        let newFile = {\n          ...file,\n          ...data\n        }\n        // 停用必须加上错误\n        if (file.fileObject && file.active && !newFile.active && !newFile.error && !newFile.success) {\n          newFile.error = 'abort'\n        }\n\n        if (this.emitFilter(newFile, file)) {\n          return false\n        }\n\n        let files = this.files.concat([])\n        let index = files.indexOf(file)\n        if (index === -1) {\n          console.error('update', file)\n          return false\n        }\n        files.splice(index, 1, newFile)\n        this.files = files\n\n        // 删除  旧定位 写入 新定位 （已便支持修改id)\n        delete this.maps[file.id]\n        this.maps[newFile.id] = newFile\n\n        // 事件\n        this.emitInput()\n        this.emitFile(newFile, file)\n        return newFile\n      }\n      return false\n    },\n\n\n\n    // 预处理 事件 过滤器\n    emitFilter(newFile, oldFile) {\n      let isPrevent = false\n      this.$emit('input-filter', newFile, oldFile, function () {\n        isPrevent = true\n        return isPrevent\n      })\n      return isPrevent\n    },\n\n    // 处理后 事件 分发\n    emitFile(newFile, oldFile) {\n      this.$emit('input-file', newFile, oldFile)\n      if (newFile && newFile.fileObject && newFile.active && (!oldFile || !oldFile.active)) {\n        this.uploading++\n        // 激活\n        this.$nextTick(function () {\n          setTimeout(() => {\n            this.upload(newFile).then(() => {\n              // eslint-disable-next-line\n              newFile = this.get(newFile)\n              if (newFile && newFile.fileObject) {\n                this.update(newFile, {\n                  active: false,\n                  success: !newFile.error\n                })\n              }\n            }).catch((e) => {\n              this.update(newFile, {\n                active: false,\n                success: false,\n                error: e.code || e.error || e.message || e\n              })\n            })\n          }, parseInt(Math.random() * 50 + 50, 10))\n        })\n      } else if ((!newFile || !newFile.fileObject || !newFile.active) && oldFile && oldFile.fileObject && oldFile.active) {\n        // 停止\n        this.uploading--\n      }\n\n      // 自动延续激活\n      if (this.active && (Boolean(newFile) !== Boolean(oldFile) || newFile.active !== oldFile.active)) {\n        this.watchActive(true)\n      }\n    },\n\n    emitInput() {\n      this.$emit('input', this.files)\n    },\n\n\n    // 上传\n    upload(id) {\n      let file = this.get(id)\n\n      // 被删除\n      if (!file) {\n        return Promise.reject('not_exists')\n      }\n\n      // 不是文件对象\n      if (!file.fileObject) {\n        return Promise.reject('file_object')\n      }\n\n      // 有错误直接响应\n      if (file.error) {\n        return Promise.reject(file.error)\n      }\n\n      // 已完成直接响应\n      if (file.success) {\n        return Promise.resolve(file)\n      }\n\n      // 后缀\n      let extensions = this.extensions\n      if (extensions && (extensions.length || typeof extensions.length === 'undefined')) {\n        if (typeof extensions !== 'object' || !(extensions instanceof RegExp)) {\n          if (typeof extensions === 'string') {\n            extensions = extensions.split(',').map(value => value.trim()).filter(value => value)\n          }\n          extensions = new RegExp('\\\\.(' + extensions.join('|').replace(/\\./g, '\\\\.') + ')$', 'i')\n        }\n        if (file.name.search(extensions) === -1) {\n          return Promise.reject('extension')\n        }\n      }\n\n      // 大小\n      if (this.size > 0 && file.size >= 0 && file.size > this.size) {\n        return Promise.reject('size')\n      }\n\n\n      if (this.features.html5 && file.putAction) {\n        return this.uploadPut(file)\n      } else if (this.features.html5) {\n        return this.uploadHtml5(file)\n      } else {\n        return this.uploadHtml4(file)\n      }\n    },\n\n    uploadPut(file) {\n      let querys = []\n      let value\n      for (let key in file.data) {\n        value = file.data[key]\n        if (value !== null && value !== undefined) {\n          querys.push(encodeURIComponent(key) + '=' + encodeURIComponent(value))\n        }\n      }\n      let queryString = querys.length ? (file.putAction.indexOf('?') === -1 ? '?' : '&') + querys.join('&') : ''\n      let xhr = new XMLHttpRequest()\n      xhr.open('PUT', file.putAction + queryString)\n      return this.uploadXhr(xhr, file, file.file)\n    },\n\n    uploadHtml5(file) {\n      let form = new window.FormData()\n      let value\n      for (let key in file.data) {\n        value = file.data[key]\n        if (value && typeof value === 'object' && typeof value.toString !== 'function') {\n          form.append(key, JSON.stringify(value))\n        } else if (value !== null && value !== undefined) {\n          form.append(key, value)\n        }\n      }\n      form.append(this.name, file.file, file.file.filename || file.name)\n      let xhr = new XMLHttpRequest()\n      xhr.open('POST', file.postAction)\n      return this.uploadXhr(xhr, file, form)\n    },\n\n    uploadXhr(xhr, _file, body) {\n      let file = _file\n      let speedTime = 0\n      let speedLoaded = 0\n\n      // 进度条\n      xhr.upload.onprogress = (e) => {\n        // 还未开始上传 已删除 未激活\n        file = this.get(file)\n        if (!e.lengthComputable || !file || !file.fileObject || !file.active) {\n          return\n        }\n\n        // 进度 速度 每秒更新一次\n        let speedTime2 = Math.round(Date.now() / 1000)\n        if (speedTime2 === speedTime) {\n          return\n        }\n        speedTime = speedTime2\n\n        file = this.update(file, {\n          progress: (e.loaded / e.total * 100).toFixed(2),\n          speed: e.loaded - speedLoaded,\n        })\n        speedLoaded = e.loaded\n      }\n\n      // 检查激活状态\n      let interval = setInterval(() => {\n        file = this.get(file)\n        if (file && file.fileObject && !file.success && !file.error && file.active) {\n          return\n        }\n\n        if (interval) {\n          clearInterval(interval)\n          interval = false\n        }\n\n        try {\n          xhr.abort()\n          xhr.timeout = 1\n        } catch (e) {\n        }\n      }, 100)\n\n      return new Promise((resolve, reject) => {\n        let complete\n        let fn = (e) => {\n          // 已经处理过了\n          if (complete) {\n            return\n          }\n          complete = true\n          if (interval) {\n            clearInterval(interval)\n            interval = false\n          }\n\n          file = this.get(file)\n\n          // 不存在直接响应\n          if (!file) {\n            return reject('not_exists')\n          }\n\n          // 不是文件对象\n          if (!file.fileObject) {\n            return reject('file_object')\n          }\n\n          // 有错误自动响应\n          if (file.error) {\n            return reject(file.error)\n          }\n\n          // 未激活\n          if (!file.active) {\n            return reject('abort')\n          }\n\n\n          // 已完成 直接相应\n          if (file.success) {\n            return resolve(file)\n          }\n\n          let data = {}\n\n          switch (e.type) {\n            case 'timeout':\n            case 'abort':\n              data.error = e.type\n              break\n            case 'error':\n              if (!xhr.status) {\n                data.error = 'network'\n              } else if (xhr.status >= 500) {\n                data.error = 'server'\n              } else if (xhr.status >= 400) {\n                data.error = 'denied'\n              }\n              break\n            default:\n              if (xhr.status >= 500) {\n                data.error = 'server'\n              } else if (xhr.status >= 400) {\n                data.error = 'denied'\n              } else {\n                data.progress = '100.00'\n              }\n          }\n\n          if (xhr.responseText) {\n            let contentType = xhr.getResponseHeader('Content-Type')\n            if (contentType && contentType.indexOf('/json') !== -1) {\n              data.response = JSON.parse(xhr.responseText)\n            } else {\n              data.response = xhr.responseText\n            }\n          }\n\n          // 更新\n          file = this.update(file, data)\n\n          // 相应错误\n          if (file.error) {\n            return reject(file.error)\n          }\n\n          // 响应\n          return resolve(file)\n        }\n\n        // 事件\n        xhr.onload = fn\n        xhr.onerror = fn\n        xhr.onabort = fn\n        xhr.ontimeout = fn\n\n        // 超时\n        if (file.timeout) {\n          xhr.timeout = file.timeout\n        }\n\n        // headers\n        for (let key in file.headers) {\n          xhr.setRequestHeader(key, file.headers[key])\n        }\n\n        // 更新 xhr\n        file = this.update(file, { xhr })\n\n        // 开始上传\n        xhr.send(body)\n      })\n    },\n\n\n\n\n    uploadHtml4(_file) {\n      let file = _file\n      let onKeydown = function (e) {\n        if (e.keyCode === 27) {\n          e.preventDefault()\n        }\n      }\n\n      let iframe = document.createElement('iframe')\n      iframe.id = 'upload-iframe-' + file.id\n      iframe.name = 'upload-iframe-' + file.id\n      iframe.src = 'about:blank'\n      iframe.setAttribute('style', 'width:1px;height:1px;top:-999em;position:absolute; margin-top:-999em;')\n\n\n      let form = document.createElement('form')\n\n      form.action = file.postAction\n\n      form.name = 'upload-form-' + file.id\n\n\n      form.setAttribute('method', 'POST')\n      form.setAttribute('target', 'upload-iframe-' + file.id)\n      form.setAttribute('enctype', 'multipart/form-data')\n\n      let value\n      let input\n      for (let key in file.data) {\n        value = file.data[key]\n        if (value && typeof value === 'object' && typeof value.toString !== 'function') {\n          value = JSON.stringify(value)\n        }\n        if (value !== null && value !== undefined) {\n          input = document.createElement('input')\n          input.type = 'hidden'\n          input.name = key\n          form.appendChild(input)\n        }\n      }\n      form.appendChild(file.el)\n\n      document.body.appendChild(iframe).appendChild(form)\n\n\n\n\n      let getResponseData = function () {\n        let doc\n        try {\n          if (iframe.contentWindow) {\n            doc = iframe.contentWindow.document\n          }\n        } catch (err) {\n        }\n        if (!doc) {\n          try {\n            doc = iframe.contentDocument ? iframe.contentDocument : iframe.document\n          } catch (err) {\n            doc = iframe.document\n          }\n        }\n        if (doc && doc.body) {\n          return doc.body.innerHTML\n        }\n        return null\n      }\n\n\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          file = this.update(file, { iframe })\n\n          // 不存在\n          if (!file) {\n            return reject('not_exists')\n          }\n\n          // 定时检查\n          let interval = setInterval(() => {\n            file = this.get(file)\n            if (file && file.fileObject && !file.success && !file.error && file.active) {\n              return\n            }\n\n            if (interval) {\n              clearInterval(interval)\n              interval = false\n            }\n\n            iframe.onabort({ type: file ? 'abort' : 'not_exists' })\n          }, 100)\n\n\n          let complete\n          let fn = (e) => {\n            // 已经处理过了\n            if (complete) {\n              return\n            }\n            complete = true\n\n\n            if (interval) {\n              clearInterval(interval)\n              interval = false\n            }\n\n            // 关闭 esc 事件\n            document.body.removeEventListener('keydown', onKeydown)\n\n            file = this.get(file)\n\n            // 不存在直接响应\n            if (!file) {\n              return reject('not_exists')\n            }\n\n            // 不是文件对象\n            if (!file.fileObject) {\n              return reject('file_object')\n            }\n\n            // 有错误自动响应\n            if (file.error) {\n              return reject(file.error)\n            }\n\n            // 未激活\n            if (!file.active) {\n              return reject('abort')\n            }\n\n            // 已完成 直接相应\n            if (file.success) {\n              return resolve(file)\n            }\n\n            let response = getResponseData()\n            let data = {}\n            switch (e.type) {\n              case 'abort':\n                data.error = 'abort'\n                break\n              case 'error':\n                if (file.error) {\n                  data.error = file.error\n                } else if (response === null) {\n                  data.error = 'network'\n                } else {\n                  data.error = 'denied'\n                }\n                break\n              default:\n                if (file.error) {\n                  data.error = file.error\n                } else if (data === null) {\n                  data.error = 'network'\n                } else {\n                  data.progress = '100.00'\n                }\n            }\n\n            if (response !== null) {\n              if (response && response.substr(0, 1) === '{' && response.substr(response.length - 1, 1) === '}') {\n                try {\n                  response = JSON.parse(response)\n                } catch (err) {\n                }\n              }\n              data.response = response\n            }\n\n            // 更新\n            file = this.update(file, data)\n\n            if (file.error) {\n              return reject(file.error)\n            }\n\n            // 响应\n            return resolve(file)\n          }\n\n\n          // 添加事件\n          iframe.onload = fn\n          iframe.onerror = fn\n          iframe.onabort = fn\n\n\n          // 禁止 esc 键\n          document.body.addEventListener('keydown', onKeydown)\n\n          // 提交\n          form.submit()\n        }, 50)\n      }).then(function (res) {\n        iframe.parentNode && iframe.parentNode.removeChild(iframe)\n        return res\n      }).catch(function (res) {\n        iframe.parentNode && iframe.parentNode.removeChild(iframe)\n        return res\n      })\n    },\n\n\n\n    watchActive(active) {\n      let file\n      let index = 0\n      while ((file = this.files[index])) {\n        index++\n        if (!file.fileObject) {\n          // 不是文件对象\n        } else if (active && !this.destroy) {\n          if (this.uploading >= this.thread || (this.uploading && !this.features.html5)) {\n            break\n          }\n          if (!file.active && !file.error && !file.success) {\n            this.update(file, { active: true })\n          }\n        } else {\n          if (file.active) {\n            this.update(file, { active: false })\n          }\n        }\n      }\n      if (this.uploading === 0) {\n        this.active = false\n      }\n    },\n\n\n    watchDrop(_el) {\n      let el = _el\n      if (!this.features.drop) {\n        return\n      }\n\n      // 移除挂载\n      if (this.dropElement) {\n        try {\n          document.removeEventListener('dragenter', this.onDragenter, false)\n          document.removeEventListener('dragleave', this.onDragleave, false)\n          this.dropElement.removeEventListener('dragover', this.onDragover, false)\n          this.dropElement.removeEventListener('drop', this.onDrop, false)\n        } catch (e) {\n        }\n      }\n\n      if (!el) {\n        el = false\n      } else if (typeof el === 'string') {\n        el = document.querySelector(el) || this.$root.$el.querySelector(el)\n      } else if (el === true) {\n        el = this.$parent.$el\n      }\n\n      this.dropElement = el\n\n      if (this.dropElement) {\n        document.addEventListener('dragenter', this.onDragenter, false)\n        document.addEventListener('dragleave', this.onDragleave, false)\n        this.dropElement.addEventListener('dragover', this.onDragover, false)\n        this.dropElement.addEventListener('drop', this.onDrop, false)\n      }\n    },\n\n\n    onDragenter(e) {\n      e.preventDefault()\n      if (!this.dropActive) {\n        this.dropActive = true\n      }\n    },\n\n    onDragleave(e) {\n      e.preventDefault()\n      if (e.target.nodeName === 'HTML' || (e.screenX === 0 && e.screenY === 0 && e.screenY === 0 && !e.fromElement && e.offsetX < 0)) {\n        this.dropActive = false\n      }\n    },\n\n    onDragover(e) {\n      e.preventDefault()\n    },\n\n    onDrop(e) {\n      e.preventDefault()\n      this.dropActive = false\n      this.addDataTransfer(e.dataTransfer)\n    },\n  }\n}\n</script>\n","module.exports = require('./FileUpload.vue')\n"],"names":["render","e","$destroy","$parent","addInputFile","target","constructor","$el","String","Boolean","Number","Object","Array","value","input","document","createElement","type","multiple","window","FormData","files","webkitdirectory","directory","features","html5","ondrop","drop","maps","$nextTick","$forceUpdate","watchDrop","destroy","active","file","i","length","fileObject","error","success","undefined","watchActive","oldMaps","id","key","newFile","oldFile","emitFile","emitInput","_files","index","addIndex","isArray","addFiles","Blob","size","webkitRelativePath","relativePath","name","Element","el","putAction","postAction","timeout","data","headers","Math","random","toString","substr","emitFilter","push","clear","newFiles","concat","splice","replace","add","dataTransfer","items","item","getAsEntry","webkitGetAsEntry","getAsFile","Promise","resolve","reject","forEach","getEntry","then","results","entry","path","isFile","isDirectory","dropDirectory","createReader","readEntries","entries","id1","id2","file1","get","file2","index1","indexOf","index2","isPrevent","$emit","uploading","upload","update","catch","code","message","parseInt","extensions","RegExp","split","map","trim","filter","join","search","uploadPut","uploadHtml5","uploadHtml4","querys","encodeURIComponent","queryString","xhr","XMLHttpRequest","open","uploadXhr","form","append","JSON","stringify","filename","_file","body","speedTime","speedLoaded","onprogress","lengthComputable","speedTime2","round","Date","now","loaded","total","toFixed","interval","setInterval","abort","complete","fn","status","progress","responseText","contentType","getResponseHeader","response","parse","onload","onerror","onabort","ontimeout","setRequestHeader","send","onKeydown","keyCode","preventDefault","iframe","src","setAttribute","action","appendChild","getResponseData","doc","contentWindow","err","contentDocument","innerHTML","removeEventListener","addEventListener","submit","res","parentNode","removeChild","thread","_el","dropElement","onDragenter","onDragleave","onDragover","onDrop","querySelector","$root","dropActive","nodeName","screenX","screenY","fromElement","offsetX","addDataTransfer","require$$0"],"mappings":"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"}