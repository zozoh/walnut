---
title:用户系统
author:zozoh
---

# 每个用户就是一个对象

系统逻辑认为

    /usr/xiaobai

存放的是登录名为 `xiaobai` 的用户档案对象。这是个 JSON 文件，内容为:

    {
        name      : "xiaobai",           // nm     : 用户名称
        password  : "34ce..23ab",        // *pwd   : 密码
        email     : "zozoh@nutzam.com",  // *email : 邮箱
        ... 之后慢慢加咯 ...
    }

# 如何记录会话信息

每当用户登录成功，系统会为其建立一个专有的会话对象

    /session/e35d..a23c

这个会话对象是个文本文件，会记录一些用户的 IP，客户端信息等数据。以备随时进行安全验证。
文件名则就是这个 session 的 ID。同时这个对象会多出下面这些属性

    me           : "xiaobai"    # * : 会话的用户
    expired      : 36000000     # * : 会话多长时间会过期(ms), 0 表示已经过期了
    lastModified : Date()       # * : 最后修改时间则变成用户最后一次访问时间(ms)

这样，我们通过 `obj` 的索引表，可以很容易查到特殊用户 `xiaobai` 正打开哪几个会话。

同时，会话对象的内容就是一个 JSON 文本，以便持久化用户保存在 Session 里面的信息。
通常这些信息可以是:
 * 字符串
 * 数字
 * 布尔
 * null
 * 数组或者Map
即，你要知道，从 Session 里恢复回来的对象是个 Map。当然你可以把它转换成任何对象

# 会话信息的清理

系统在两个时刻会清理会话，一个是 `登录`，因为登录会创建一个会话，因此可以尝试看看有哪些会话过期，以保证过期会话总数不会太多
另一个是后台专门清理过期会话的机器人，它会不定期的运行，以控制过期会话总是不会太多


# HTTP 接口

## /usr/born : 创建用户
## /usr/signup : 登录
## /usr/signout: 退出登录
