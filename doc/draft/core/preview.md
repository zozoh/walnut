---
title:预览机制
author:zozoh, pw
tags:
- 系统
- 预览
- 缩略图
---

# 预览

* 系统为任何对象都提供了预览
* 为图片提供缩略图
* 为视频提供默认截图与预览视频
* 为纯文本文件提供前n行的文本展示
* 为office文档提供前n页的截图
* ......
* 为所有类型文件提供默认的缩略图, 包括暂未支持的文件类型


## 缩略图概述

* 系统为任何对象都提供了缩略图。
* 用户可以自定义缩略图
* 如果没有自定义缩略图，可以访问系统的默认缩略图
* 缩略图有三种固定的尺寸：
    * 大 : 256x256
    * 中 : 64x64
    * 小 : 24x24
* 缩略图后缀搜索的顺序是  `png > jpg > gif > jpeg`

### 默认缩略图存放的位置

```
/etc/thumbnail/
    jpg                # "jpg"  类型文件的缩略图
        256x256.png    # 大
        64x64.png      # 中
        24x24.png      # 小
    jpeg               # "jpeg" 类型文件的缩略图
    txt                # "txt"  类型文件的缩略图
    unknown            # 所有其他类型文件的缩略图
```

### 自定义缩略图的存放位置

```
$HOME/.preview_thumbnail
    id                     # 目录对象通过 ID 找缩略图
        78d1..             
    sha1                   # 文件对象，通过 SHA1 找缩略图
        45cf..ecd1         # 对象的SHA1对应一个缩略图
            256x256.jpg    # 大
            64x64.jpg      # 中
            24x24.jpg      # 小
        7cf2..d538         # 这个文件夹下基本会有很多很多缩略图
```


### 视频预览概述

* 包含"预览图片,预览视频"两部分
* 大小全部按照原分辨率等比例缩小, 默认为1/4大小
* 预览图片为jpg格式, 将按照缩略图的位置存放
* 预览视频为mp4格式, 支持浏览器中播放


### 自定义视频预览的存放位置

```
$HOME/.preview_video
    sha1                   # 文件对象，通过 SHA1 查找
        45cf..ecd1         # 对象的SHA1对应一个预览视频
            preview.mp4
        7cf2..d538         
```å















