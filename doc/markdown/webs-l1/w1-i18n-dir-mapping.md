---
title: 多语言目录映射模型
author: zozohtnt@gmail.com
key: w1-idm
---

--------------------------------------
# 动机：为什么要有这个模型

如果想建立一个国际化内容输出的站点。通常用户生产的数据将根据语言产生多份。
为此，我们很自然的想到每个语言版本准备一个目录。

但是通常多语言的内容生产系统，总是以某一个语言（譬如英文）为主干，
然后后期逐渐增加其他语言的内容。如果其没有找到对应语言内容，则采用主干的内容。

因此我们最好规划处一个套路好的目录模型，这样，我们就可以在这个标准目录上
构建更方便用户的操作界面和内置功能了。

--------------------------------------
# 计划应用场景

- WIKI站点
- 视频/音频站

--------------------------------------
# 设计思路与边界

因为是用户生产内容，通过网站传播这种场景。用户编辑的内容上限也就是类似`wiki`那种规模，
同时这种内容往往需要一个无限级别的树形分类体系。因此存放内容采用`目录`而不是`数据集`更加自然。

--------------------------------------
# 数据结构描述

## 目录布局

```bash
# 以域的某个文件夹为主目录，下面的就是我们设计的多语言目录结构
~/path/to/home/
#-------------------------------------
# 在系统中，采用 ISO 639+3166 小写形式作为区域语言的编码
# 需要指定一个主干语言，默认为 "zh-cn"
|-- zh-cn/
|   |-- catetoryA/         # 第一层为主分类
|   |   |-- A_0/           # 第二层为子分类
|   |   |   |-- _content.md     # _content文件名，表示目录的显示内容
|   |   |   |-- article_0.md    # 分类文章,采用 {sort:1} 来约束列表顺序
|   |   |   |-- article_1.md    # 文章对应的嵌入式媒体等，应该统一放置在
|   |   |   |-- ...             # 另外一个独立的媒体库文件夹
|   |-- catetoryB/
|   |-- ../
#-------------------------------------
# 另外的语言体系必须确保与主干路径相同
|-- en-us/
|-- zh-hk/
|-- zh-tw/
|-- ...
```

- 依靠 `_content` 来展示目录的默认展示内容
- 依靠 `{sort:1}` 来定义文件的列表顺序(`ASC`)

## 目录元数据

```bash
id : ID               # 目录 ID
nm : "xxx"            # 目录路径名
#
# 下面是主目录的属性
#
title : "xxxx"        # 目录显示名（主干）
title_en_us : "xxx"   # 某语言版本标题
title_zh_hk : "xxx"   # 某语言版本标题
sort : 1              # 在父目录下的排序值
```

## 文件元数据

```bash
id : ID               # 目录 ID
nm : "xxx"            # 目录路径名
#
# 下面是主干文件的属性
#
title : "xxxx"        # 目录显示名（主干）
title_en_us : "xxx"   # 某语言版本标题
title_zh_hk : "xxx"   # 某语言版本标题
sort : 1              # 在父目录下的排序值
```

--------------------------------------
# 操作命令

为了方便这种目录结构的操作，系统提供了`cmd_i18ndir` 命令：

```bash
i18ndir @create        # 创建
i18ndir @remove        # 删除
i18ndir @query         # 查询某层目录结构
i18ndir @update        # 修改
```

> 详情请参看命令说明 `man i18ndir`

--------------------------------------
# 相关知识点

