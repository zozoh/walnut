---
title: 域账户模型
author: zozohtnt@gmail.com
tags:
- 功能扩展
- 域账户
---

--------------------------------------
# 动机：为什么要有域账户

[基础账户模型][c0-acc]提供了`Walnut`的登录校验能力。但是作为一个域的用户，很多时候想拥有一套甚至多套自己的账户体系。


--------------------------------------
# 计划应用场景

- 用户自建的网站
- 用户域多账户协同工作

--------------------------------------
# 设计思路与边界

首先允许用户在自己的域中自建`通用数据集`，数据集的字段符合一定的约定。
用户可以通过`HttpApi`对外提供本域的注册登录功能，会话数据也存放在本域中

如果用户登录Walnut账户，只要指定用户的这个`通用数据集`，那么也可以创建一个标准系统级会话。
但是账户的数据访问权限仅限于当前域。

--------------------------------------
# 数据结构描述

域账户的`通用数据集`必须具备如下元数据

```bash
id : ID            # 【唯一】唯一的用户 ID
thumb : "id:xxx"   # 用户的头像文件
#-------------------------------------------------
# 关键信息
grp   : "xiaobai"  # 用户的主组
role  : "user"     # 用户业务角色名，角色库的 'nm' 段值
nm    : "xxx"      # 【唯一】用户的登录名，默认为 ID
phone : "139.."    # 【唯一】绑定手机
email : "x@y.z"    # 【唯一】绑定邮箱
#-------------------------------------------------
# 密码/盐
passwd : "xxx"     # 加盐后密码
salt   : "xxx"     # 盐值（随机数）
#-------------------------------------------------
# 基本信息
sex : 1,           # 性别：1=男; 2=女
nickname : "xxx"   # 用户昵称
country  : "xxx"   # 国家
province : "xxx"   # 省/直辖市
city     : "xxx"   # 市/市辖区
#-------------------------------------------------
# 微信公号
wx_gh_xxx : "xxx"     # 某微信公号下的 OpenId
#-------------------------------------------------
# 时间戳
ct    : AMS     # 创建/注册时间
lm    : AMS     # 最后修改时间
login : AMS     # 最后登录时间
```

--------------------------------------
# 使用方式

通过命令 `www auth` 可以实现用户的登录操作

--------------------------------------
# 相关知识点

- [基础账户模型][c0-acc]
- [核心会话服务][c0-ses]

[c0-acc]: ../core-l0/c0-account-basic.md
[c0-ses]: ../core-l0/c0-session-top.md
[c0-pvg]: ../core-l0/c0-pvg-basic.md
[c2-pvg]: ../core-l2/c2-pvg-more.md
[f0-wxp]: ../func-l0/f0-weixin-payment.md
[f0-zfb]: ../func-l0/f0-alipay.md
[f1-pay]: ../func-l1/f1-payment.md
[w0-acc]: ../webs-l0/w0-account-in-domain.md